# 生产环境部署说明

## 适用场景
- 需要自动展示服务器上上传的原型目录
- 首页文件放在目录同级别
- 使用Node.js作为后端服务

## 需要上传的文件

```
server.js       # Node.js后端服务器
package.json    # 项目依赖配置
package-lock.json # 锁定依赖版本（推荐）
public/         # 前端文件目录
  ├── index.html
  ├── style.css
  └── script.js
```

## 部署步骤

### 1. 上传文件
将项目文件上传到服务器，放在**需要展示的目录的同级别**。

例如：
```
/var/www/prototypes/
├── server.js
├── package.json
├── package-lock.json
├── public/
│   ├── index.html
│   ├── style.css
│   └── script.js
├── prototype1/     # 这些是要展示的目录
├── prototype2/
└── prototype3/
```

### 2. 安装依赖
```bash
cd /var/www/prototypes
npm install --production
```

### 3. 启动服务

#### 方式一：直接启动
```bash
npm start
```

#### 方式二：使用PM2（推荐）
```bash
npm install -g pm2
pm2 start server.js --name "folder-display"
pm2 save
pm2 startup  # 设置开机自启
```

#### 方式三：使用Nginx反向代理
如果使用Nginx作为反向代理，配置如下：
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### 4. 访问首页
在浏览器中访问：`http://your-domain.com:3000` 或通过Nginx代理访问

## 功能说明

1. **自动扫描目录**：自动读取首页所在目录下的所有文件夹
2. **卡片展示**：以卡片形式展示每个文件夹
3. **显示信息**：目录名称、最近修改时间
4. **编辑名称**：支持在线编辑卡片显示名称（保存到 `custom-names.json`）
5. **自动刷新**：每30秒自动刷新一次

## 文件说明

- `server.js` - Node.js后端服务器，处理目录读取和名称保存
- `package.json` - 项目依赖配置
- `public/index.html` - 主页面
- `public/style.css` - 样式文件
- `public/script.js` - 前端JavaScript逻辑
- `custom-names.json` - 自动生成，存储自定义卡片名称

## 注意事项

1. **Node.js版本**：需要Node.js 12+（推荐Node.js 14+）
2. **端口配置**：默认端口为3000，可在 `server.js` 中修改 `PORT` 常量
3. **文件权限**：确保Node.js进程有读取目录的权限
4. **自定义名称**：`custom-names.json` 会在首次编辑名称时自动创建
5. **排除规则**：自动排除隐藏文件夹（以`.`开头）和 `node_modules`
6. **安全性**：如果目录包含敏感信息，建议配置访问控制和防火墙规则
7. **进程管理**：生产环境建议使用PM2等进程管理器

## 最小部署包

必需文件：
- `server.js`
- `package.json`
- `public/` 目录（包含所有前端文件）

可选文件：
- `package-lock.json` - 锁定依赖版本（推荐）

